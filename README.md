# CodeGen25-7B Mono - Генерация кода с помощью ИИ

Этот проект содержит скрипты для работы с моделью CodeGen25-7B Mono от Salesforce, которая специализируется на генерации кода на Python.

## Требования

- Python 3.8 или выше
- PyTorch
- Transformers
- CUDA-совместимая видеокарта (рекомендуется для быстрой работы)

## Установка

1. Клонируйте репозиторий:
```bash
git clone https://github.com/your-username/llm.git
cd llm
```

2. Создайте виртуальное окружение и активируйте его:
```bash
python -m venv venv
source venv/bin/activate  # для Linux/Mac
# или
venv\Scripts\activate  # для Windows
```

3. Установите зависимости:
```bash
pip install torch transformers
```

## Использование

В проекте есть два основных скрипта:

### 1. test_model.py

Этот скрипт демонстрирует базовую работу с моделью, показывая примеры генерации кода через pipeline.

Запуск:
```bash
python test_model.py
```

При первом запуске скрипт автоматически загрузит модель (около 7GB). Это может занять некоторое время в зависимости от скорости интернета.

### 2. run_model.py

Интерактивный скрипт для генерации кода. Позволяет:
- Вводить свои промпты для генерации кода
- Генерировать код с различными параметрами

Запуск:
```bash
python run_model.py
```

Примеры промптов:
- `def calculate_fibonacci(n):`
- `class User:`
- `def sort_array(arr):`
- `async def fetch_data(url):`

## Параметры генерации

В скриптах используются следующие параметры генерации:
- `max_length`: максимальная длина генерируемого кода (по умолчанию 200 токенов)
- `temperature`: параметр температуры (0.7) - чем выше, тем более креативный результат
- `top_p`: параметр ядерной выборки (0.95) - контролирует разнообразие генерации
- `do_sample`: включена случайная выборка для более естественных результатов

## Примечания

1. Модель автоматически загружается при первом запуске и сохраняется в кэш
2. Для работы рекомендуется иметь GPU с минимум 8GB видеопамяти
3. При использовании CPU генерация может быть медленной
4. Все сгенерированные файлы моделей и кэш игнорируются git'ом

## Возможные проблемы

1. **Нехватка памяти**: Если возникает ошибка CUDA out of memory, попробуйте:
   - Уменьшить `max_length`
   - Использовать CPU вместо GPU
   - Использовать модель с меньшим количеством параметров

2. **Медленная загрузка**: Первая загрузка модели может занять время из-за большого размера файлов

3. **Ошибки генерации**: Если модель генерирует некорректный код, попробуйте:
   - Уменьшить `temperature`
   - Сделать промпт более конкретным
   - Увеличить `max_length`

## Лицензия

Модель CodeGen25-7B Mono распространяется под лицензией Salesforce. Пожалуйста, ознакомьтесь с условиями использования на странице модели в Hugging Face Hub. 